{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"./api-call.service\";\nimport * as i2 from \"@angular/router\";\n/*\nThe login will call the API and log in a user.\nThis logs on the user on the client save, and saves it as userOn.\nIt also logs in the user in the database via API.\nSeveral users can be logged into the database.\nOnly one at a time logged into the client.\n\nThis service provides a boolean if a user is logged on (and user email on request).\nThus can be injected as a service to other components.\nAnd then, check if a user is logged on or not before doing some action.\n*/\nexport class LoginService {\n  constructor(ApiCallService, router) {\n    this.ApiCallService = ApiCallService;\n    this.router = router;\n    this.userLoggedOn = false;\n    this.userOn = {};\n    this.response = '';\n    this.users = [];\n  }\n  // Get user on\n  getUserOn() {\n    if (this.userLoggedOn) {\n      return this.users;\n    }\n    return false;\n  }\n  // Return the user on\n  getUserOnline() {\n    return this.userOn;\n  }\n  // Get all users\n  getUsers() {\n    return this.users;\n  }\n  // Log out user\n  logOut() {\n    this.userLoggedOn = false;\n    this.response = 'Logged out';\n    this.logoutApi();\n  }\n  // Callback \n  // Login\n  callback1(thisObj, res, result) {\n    console.log(result);\n    console.log(res);\n    // thisObj.response = result.data.msg;\n    if (result.data != undefined) {\n      if (result.data.msg != undefined) {\n        // log out all users \n        thisObj.userLoggedOn = true;\n        thisObj.response = 'User logged on';\n        thisObj.userLoggedOn = true;\n        thisObj.users = {\n          name: 'loggedOn'\n        };\n        console.log(thisObj.users);\n        thisObj.router.navigate(['reportApi']);\n      }\n    }\n    if (result.error != undefined) {\n      // thisObj.userLoggedOn = false;\n      thisObj.response = result.error;\n      thisObj.userOn = {};\n      thisObj.users = {\n        name: 'error'\n      };\n      console.log(thisObj.users);\n    }\n  }\n  // Logout\n  callback2(thisObj, res, result) {\n    console.log(result);\n    console.log(res);\n    // thisObj.response = result.data.msg;\n    if (result.data != undefined) {\n      if (result.data.msg != undefined) {\n        thisObj.userLoggedOn = false;\n        thisObj.response = 'User logged off';\n        thisObj.users = {};\n      }\n    }\n    if (result.error != undefined) {\n      // thisObj.userLoggedOn = false;\n      thisObj.response = result.error;\n      thisObj.userOn = {};\n      thisObj.users = {\n        name: 'error'\n      };\n      console.log(thisObj.users);\n    }\n  }\n  // Login\n  login(email, password) {\n    var url = 'https://me-api.ysojs.se/users/login';\n    var params;\n    var token = null;\n    var obj1 = this;\n    params = {\n      \"email\": email,\n      \"password\": password\n    };\n    this.response = '';\n    this.ApiCallService.fetchCall(params, url, 'POST', this.callback1, token, obj1);\n    this.userOn = {\n      \"email\": email\n    };\n  }\n  logoutApi() {\n    var url = 'https://me-api.ysojs.se/users/logout';\n    var params;\n    var token = null;\n    var obj1 = this;\n    this.response = '';\n    this.ApiCallService.fetchCall(params, url, 'POST', this.callback2, token, obj1);\n    this.userOn = {};\n  }\n  static #_ = this.ɵfac = function LoginService_Factory(t) {\n    return new (t || LoginService)(i0.ɵɵinject(i1.ApiCallService), i0.ɵɵinject(i2.Router));\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: LoginService,\n    factory: LoginService.ɵfac,\n    providedIn: 'root'\n  });\n}","map":{"version":3,"names":["LoginService","constructor","ApiCallService","router","userLoggedOn","userOn","response","users","getUserOn","getUserOnline","getUsers","logOut","logoutApi","callback1","thisObj","res","result","console","log","data","undefined","msg","name","navigate","error","callback2","login","email","password","url","params","token","obj1","fetchCall","_","i0","ɵɵinject","i1","i2","Router","_2","factory","ɵfac","providedIn"],"sources":["/mnt/c/Users/ylva/dbwebbkurser/jsramverk/2023version/yso/projektJs2024/frontendProj/src/app/login.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\n\nimport { ApiCallService } from './api-call.service';\n\nimport { User } from './User';\n\nimport { Router } from '@angular/router';\n\n\n\n/* \nThe login will call the API and log in a user.\nThis logs on the user on the client save, and saves it as userOn.\nIt also logs in the user in the database via API. \nSeveral users can be logged into the database. \nOnly one at a time logged into the client.\n\nThis service provides a boolean if a user is logged on (and user email on request).\nThus can be injected as a service to other components.\nAnd then, check if a user is logged on or not before doing some action.\n*/\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class LoginService {\n\n  private userLoggedOn = false;\n  private userOn = {};\n\n  response = '';\n\n  users : User[] = [];\n\n  constructor( \n    private ApiCallService: ApiCallService,\n    private router: Router) { }\n\n    // Get user on\n    getUserOn() {\n      if (this.userLoggedOn) {\n        return this.users;\n      }\n      return false;\n    }\n\n    // Return the user on\n    getUserOnline() {\n      return this.userOn;\n    }\n\n    // Get all users\n    getUsers() {\n        return this.users;\n    }\n\n    // Log out user\n    logOut() {\n      this.userLoggedOn = false;\n      this.response = 'Logged out';\n      this.logoutApi();\n    }\n\n    // Callback \n    // Login\n    callback1(thisObj, res, result) {\n      console.log(result);\n      console.log(res);\n      // thisObj.response = result.data.msg;\n\n      if (result.data != undefined) {\n        if (result.data.msg != undefined) {\n          // log out all users \n          \n          thisObj.userLoggedOn = true;\n          thisObj.response = 'User logged on';\n\n          thisObj.userLoggedOn = true;\n          thisObj.users = {name:'loggedOn'};\n\n          console.log(thisObj.users)\n\n          thisObj.router.navigate(['reportApi']);\n        }\n      }\n\n      if (result.error != undefined) {\n          // thisObj.userLoggedOn = false;\n          thisObj.response = result.error;\n          thisObj.userOn = {};\n          thisObj.users = {name:'error'};\n\n          console.log(thisObj.users)\n      }\n    }\n\n    // Logout\n    callback2(thisObj, res, result) {\n      console.log(result);\n      console.log(res);\n      // thisObj.response = result.data.msg;\n\n      if (result.data != undefined) {\n        if (result.data.msg != undefined) {\n          thisObj.userLoggedOn = false;\n          thisObj.response = 'User logged off';\n          thisObj.users = {};\n        }\n      }\n\n      if (result.error != undefined) {\n          // thisObj.userLoggedOn = false;\n          thisObj.response = result.error;\n          thisObj.userOn = {};\n          thisObj.users = {name:'error'};\n\n          console.log(thisObj.users)\n      }\n    }\n\n\n    // Login\n    login(email, password) {\n      var url = 'https://me-api.ysojs.se/users/login';\n      var params;\n      var token = null;\n      var obj1 = this;\n      params = {\"email\":email, \"password\":password};\n      this.response = '';\n\n      this.ApiCallService.fetchCall(params ,url, 'POST', this.callback1, token, obj1);\n      this.userOn = {\"email\":email}\n    }\n\n    logoutApi() {\n      var url = 'https://me-api.ysojs.se/users/logout';\n      var params;\n      var token = null;\n      var obj1 = this;\n      this.response = '';\n\n      this.ApiCallService.fetchCall(params ,url, 'POST', this.callback2, token, obj1);\n      this.userOn = {}\n    }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}